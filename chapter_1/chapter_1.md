# Chapter1

## モダンJavaScript概説

一般的に以下がモダンJavaScriptの特徴として挙げられる

- React, Vue, Angular等の仮想DOMを用いるライブラリ/フレームワークを使用
- npm/yarn等のパッケージマネージャーを使用
- 主にES2015(ES6)以降の記法を使用
- webpack等のモジュールバンドラーを使用
- Babel等のトランスパイラを使用
- SPA(Single Page Application)で作成



## DOM、仮想DOM

**DOM**はHTMLを解釈し木構造で表現したもので、**Document Object Model**の略となる。Webブラウザから開発者ツールを開くことで見ることが可能。従来、JavaScriptで画面の要素を変更する場合は、DOMを直接指定して書き換えるような処理をしてきた。以下は、プレーンなJavaScriptを用いて画面に要素を追加するコードの例である。

```javascript
// id=satoichi を持つ要素の配下にHello World!!と設定したpタグを差し込む
var textElement = document.createElement("p");
textElement.textContent = "Hello World!!";
document.getElementById("satoichi").appendChild(textElement);
```

このようなコードは手続き的でわかりやすい反面、レンダリングコスト(画面の表示速度)に問題が生じやすかったり、プログラムコードが肥大化してくるとどこで何をしているかわからなくなるという問題も生じる。



### 仮想DOMとは

　仮想DOMとはJavaScriptのオブジェクトで作られた仮想的なDOMのことである。これを用い実際のDOMとの差分を比較し==変更箇所のみを実際のDOMに反映==することで、DOMへの操作を最小限に抑えることが可能になる。

　ReactやVue等のモダンJavaScriptのフレームワークやライブラリでは仮想DOMが用いられている。そのため、ページ遷移をJavaScriptによる画面の書き換えで表現しているが、レンダリングコストを最小限に抑えて快適なWebシステムを提供することが可能となっている。



## パッケージマネージャー(npm/yarn)

　かつてのJavaScript開発では処理を全て1つのファイルに記載していた。そのため複雑なシステムの場合はコードが数千行以上になることもある。さらにそれらのコードは再利用することができず、非常に効率の悪い開発となっていた。

　そこで少し改善されたJavaScript開発では、jsファイルから他のjsファイルを読み込んで使用できるようになった。これによりコードの共通化や再利用が可能になった。これによりコードの共通化や再利用が可能になった。しかし、読み込み順を意識しないとエラーになったり、読み込んだ関数や変数を使用する場合に、何がどこから読み込まれたのかが非常に分かりづらかったりするという問題は依然としてあった。

　現在のモダンJavaScript開発では**npm**や**yarn**などの**パッケージマネージャー**を使用することで、前述の問題点を大幅に改善している。



### パッケージマネージャーとは

　バックエンド、フロントエンドを問わず、どのプログラミング言語で開発するにしても基本的には外部で公開されている様々なパッケージを利用して開発していくことになる。

　パッケージをインストールする際に開発者がそれぞれのPCに自由にインストールしてしまうとバージョンがばらばらになって、同じ環境を再現するのが非常に手間になってしまう。

　そこで現在はパッケージマネージャーと呼ばれるパッケージの管理、インストール、アップグレード等を担ってくれる管理ツールを使用することが一般的となっている。

- JavaScriptのnpm
- Rubyのgem
- PHPのcomposer

npmやyarnには以下のようなメリットがあり、これまでの課題を解決している。

- 依存関係を意識しなくても勝手に解決してくれる
- チーム内でのパッケージの共有や、バージョン統一が容易
- 世界中で公開されているパッケージをコマンド1つで利用可能
- どこから読み込んだものかわかりやすくなった



### 近代JavaScriptの転換期

　==近代JavaScriptの転換期==と呼ばれる改定があったのがES2015である。

この年に大きな機能追加が実施され、React等のモダンJavaScript開発でも必須といえる文法や機能が加わった。追加された仕様の例として以下のものがある。

- let, constを用いた変数宣言
- アローファンクション
- Class構文
- 分割代入
- テンプレート文字列
- スプレッド構文
- Promise

etc...



## モジュールバンドラー、トランスパイラ

　モダンJavaScriptの開発においては、**モジュールバンドラー**や**トランスパイラ**と呼ばれる仕組みが必須になる。



### モジュールバンドラー

　JavaScriptは細かく分けて開発していったほうが効率的で、生産性も上がる。

　しかし本番環境で実行する時はファイルが分かれている必要はない。むしろ読み込みの回数が増えてパフォーマンスが悪くなる場合がある。

　そこで「==開発はファイルを分けて行い、本番用にビルドする時に1つのファイルにまとめる==」という思想を実現するために、jsファイルやcssファイル等をまとめてくれるモジュールバンドラーが作られた。

　JavaScriptには読み込み順による依存関係の問題があり、パッケージマネージャーはそれを解決してくれるが、モジュールバンドラーもまたファイルを1にまとめる際に依存関係を解決してくれるものである。

　あらかじめ設定ファイルを記述しておくことで、開発者は何も意識することなく開発を行い、ビルドを実行するとモジュールバンドラーがいい感じにファイルをまとめてバンドル後のファイルを生成してくれるので、そのファイルを本番環境に反映することでプログラムを実行することができる。

　現在主流のモジュールバンドラーは**webpack**と呼ばれるものとなっている。



### トランスパイラ

　モジュールバンドラーが複数のファイルを1つにまとめてくれるものだとしたら、トランスパイラは**==JavaScriptの記法をブラウザで実行できる形に変換してくれるもの==**である。



